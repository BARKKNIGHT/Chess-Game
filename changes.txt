=============================================================================
CHESS MOVE SUGGESTIONS & IMPROVED CONTROLS - IMPLEMENTATION GUIDE
=============================================================================

This guide explains how to add:
  1. Move suggestions (legal move highlighting)
  2. Both click AND drag controls on desktop
  3. No piece fading when dragging

=============================================================================
FEATURE 1: MOVE SUGGESTIONS (LEGAL MOVE HIGHLIGHTING)
=============================================================================

STEP 1: Update ChessBoard Component Props
-----------------------------------------
In your ChessBoard.jsx, add a new prop to receive the chess.js instance:

    const ChessBoard = ({
      board,
      color,
      started,
      // ... other existing props
      gameOver,
      chess, // ADD THIS - chess.js instance from parent
    }) => {


STEP 2: Add State for Valid Moves
---------------------------------
Add a new state variable to track valid moves:

    const [validMoves, setValidMoves] = useState([]);


STEP 3: Add useEffect to Calculate Valid Moves
----------------------------------------------
Add this effect to calculate legal moves when a piece is selected:

    // Calculate valid moves when a piece is selected
    useEffect(() => {
      if (selectedSquare && chess && started && !gameOver) {
        try {
          const moves = chess.moves({ square: selectedSquare, verbose: true });
          setValidMoves(moves.map(move => move.to));
        } catch (e) {
          setValidMoves([]);
        }
      } else if (from && chess && started && !gameOver) {
        try {
          const moves = chess.moves({ square: from, verbose: true });
          setValidMoves(moves.map(move => move.to));
        } catch (e) {
          setValidMoves([]);
        }
      } else {
        setValidMoves([]);
      }
    }, [selectedSquare, from, chess, started, gameOver]);


STEP 4: Add Visual Indicators in the Square Rendering
------------------------------------------------------
Inside each square's <div>, add these indicators BEFORE the piece image:

    {/* Valid move indicator - dot for empty square */}
    {validMoves.includes(squareRepresentation) && !square && (
      <div className="absolute w-1/3 h-1/3 rounded-full bg-black/30 pointer-events-none z-10" />
    )}

    {/* Valid move indicator - ring for capture */}
    {validMoves.includes(squareRepresentation) && square && (
      <div className="absolute inset-0 rounded-full border-[4px] md:border-[5px] border-black/30 pointer-events-none z-10 m-[2px]" />
    )}

NOTE: Make sure the parent square div has "relative" in its className.


STEP 5: Pass Chess Instance from Parent (Game.jsx)
---------------------------------------------------
In your Game screen, pass the chess instance to ChessBoard:

    <ChessBoard
      // ... existing props
      chess={chessRef.current}
    />


=============================================================================
FEATURE 2: BOTH CLICK AND DRAG ON DESKTOP
=============================================================================

Replace the Conditional Event Handlers
--------------------------------------
Instead of using {...(!isMobileView && { ... })} pattern, make handlers always active:

    <div
      // Drag and drop handlers (always active)
      onDragOver={(e) => e.preventDefault()}
      onDrop={() => {
        if (from) {
          socket.emit(MOVE, {
            move: { from, to: squareRepresentation },
            gameId,
          });
          setFrom(null);
          setSelectedSquare(null);
        }
      }}
      // Click-to-move handler (always active)
      onClick={() => {
        if (!selectedSquare) {
          if (square) {
            setSelectedSquare(squareRepresentation);
          }
        } else {
          // Toggle off if clicking same square
          if (selectedSquare === squareRepresentation) {
            setSelectedSquare(null);
            return;
          }
          socket.emit(MOVE, {
            move: { from: selectedSquare, to: squareRepresentation },
            gameId,
          });
          setSelectedSquare(null);
        }
      }}
      // ... rest of div props
    >


=============================================================================
FEATURE 3: NO PIECE FADING WHEN DRAGGING
=============================================================================

Update the <img> Element for Pieces
-----------------------------------
Replace the piece image with custom drag handling:

    <img
      onDragStart={(e) => {
        setFrom(squareRepresentation);
        setSelectedSquare(null);
        
        // Create custom drag image to prevent fading
        const img = e.target.cloneNode(true);
        img.style.position = 'absolute';
        img.style.top = '-9999px';
        img.style.opacity = '1';
        document.body.appendChild(img);
        e.dataTransfer.setDragImage(img, img.width / 2, img.height / 2);
        setTimeout(() => document.body.removeChild(img), 0);
      }}
      onDragEnd={() => {
        setFrom(null);
      }}
      className="w-15 cursor-grab active:cursor-grabbing relative z-0"
      style={{ opacity: 1 }}
      src={`/${square?.color === "b" ? `b${square?.type}` : `w${square?.type?.toLowerCase()}`}.png`}
      draggable="true"
    />


=============================================================================
SUMMARY OF CHANGES
=============================================================================

FILE: ChessBoard.jsx
  - Add "chess" prop
  - Add "validMoves" state
  - Add useEffect for move calculation
  - Add visual indicators (dot/ring divs)
  - Make click/drag handlers always active (remove isMobileView conditions)
  - Add custom drag image to prevent fading

FILE: Game.jsx
  - Pass chess={chessRef.current} to ChessBoard component


=============================================================================
RESULT
=============================================================================

After implementing these changes, you will have:
  ✓ Valid move hints (dots for empty squares, rings for captures)
  ✓ Yellow highlight on selected piece
  ✓ Both click-to-move and drag-and-drop on all devices
  ✓ No fading/ghosting when dragging pieces
